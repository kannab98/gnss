## Функция максимального правдоподобия {#функция-максимального-правдоподобия .unnumbered}

Пусть $s_T(t))$ -- цифровой сигнал на входе в приемник, тогда сигнал на
выходе GNSS-приемника может быть представлен следующим образом
$$x_{\text{вх}} = A(t)\tilde s_T (t - \tau(t) ) e^{j(2\pi f_D(t)t + \varphi(t))}
    + n(t),$$ где $A(t)$ -- амплитуда сигнала, $\tilde s_T (t)$ --
сигнал $s_T(t)$ после прохождения фильтра, $\tau(t)$ -- кодовая
задержка, $f_D(t)$ -- допплеровское смещение частоты, $\varphi(t)$ --
фазовый сдвиг несущей, $n$ -- тепловой шум, $T_s$ -- частота
дискретизации.

GNSS-приемник должен определить находится ли спутник, соответствующий
опорному сигналу $d[k]$ в поле зрения или нет. Для этого используется
функция неопределенности (так что-ли она на русском?)
$\hat R_{xd}(f_D, \tau)$

$$\label{eq:}
    \hat R_{xd}(f_D, \tau) = \frac{1}{K} \sum\limits_{k=0}^{K-1}
    x_{\text{вх}}[k] d[kT_s - \tau] e^{-j 2\pi f_d kT_s}$$

Критерий для задачи обнаружения можно выбирать исходя из максимума
вероятности правильного обнаружения при заданной вероятности ложной
тревоги. Как известно, что оптимальное решение такой задачи можно найти
с помощью критерия Неймана-Пирсона.

Тогда можно получить функцию отношения правдоподобия (Generalized
Likelihood Ratio Test)
$$\Gamma_{GLRT}(x_{\text{вх}}) = max\qty{\frac{\abs{\hat R_{xd} (f_d,
    \tau)}^2}{\hat R_{xx}}},$$ где $R_{xx}^2$ -- мощность сигнала на
входе.

## Используемое оборудование {#sub:ispol_zuemoe_oborudovanie .unnumbered}

![Блок файла конфигурации программы
GNSS-SDR](imgs/screen_config.png){#fig:config width="0.7\\linewidth"}

Для приема спутникового сигнала использовался телевизионный приемник
Realtek RTL2832U стандарта DVB-T и комплекс программного обеспечения с
открытым исходным кодом GNSS-SDR (Software Defined Receiver). Управление
программой осуществлялось на операционной системе GNU/Linux при помощи
интерфейса командной строки и конфигурационных файлов.

Ниже представлен алгоритм с помощью которого $GNSS-SDR$ формирует
функцию максимального правдоподобия $\Gamma_{GLRT}$

Для $GPS$ спутников программа работает по следующему алгоритму

1.  Вычисляется мощность входного сигнала $\hat R_{xx} = P_{in} =
            \frac{1}{K} \sum\limits_{k=0}^{K-1} \abs{x_{in}[k]}^2$

2.  Для выбранной полосы частот $\hat f_D = [f_{min}, f_{max}]$ с шагом
    $f_{step}$:

    -   Убирается несущая частота
        $x[k] = x_{in}[k] \cdot e^{-j2\pi\hat f_D k T_s}$

    -   Вычисляется прямое Фурье-преобразование $X[k]= FFT\qty{x[k]}$

    -   Вычисляется $Y[k]= X[k] \cdot D[k]$, где $D[k]=FFT\qty{d[k]}$

    -   Вычисляется $R_{xd}(\hat f_D, \tau)= \frac{1}{K^2}
                        IFFT\qty{Y[k]}$

3.  Находится $S_{max}$ максимум функции $\abs{R_{xd}}^2$
    $$\{ S_{max}, f_i, \tau_j\} \leftarrow max \abs{R_{xd}(f, \tau)}^2$$

4.  Вычисляется функция
    $\Gamma_{GLRT} = \frac{2 \cdot K \cdot S_{max}}{P_{in}}$

5.  Если $\Gamma_{GLRT}$ больше наперед выбранного порога $\gamma$, то
    задача решена и $f_D = f_i$ и $\tau=\tau_j$

6.  Если $\Gamma_{GLRT}$ меньше наперед выбранного порога $\gamma$, то
    определить $f_D$ и $\tau$ не удалось

Таким образом, для того, чтобы получить функцию $\Gamma_{GLRT}$
необходимо задать следующие начальные параметры:

-   Полосу частот $[f_{min}, f_{max}]$

-   Шаг в выбранной полосе $f_{step}$

-   Порог обнаружения $\gamma$

Пример файла конфигурации представлен на рис.
[1](#fig:config){reference-type="ref" reference="fig:config"}

## Проведение эксперимента на стационарной морской платформе {#проведение-эксперимента-на-стационарной-морской-платформе .unnumbered}

### Широкая диаграмма направленности антенны {#ssub:shirokaia_diagramma_napravlennosti_antenny .unnumbered}

На рис. [3](#fig:1){reference-type="ref" reference="fig:1"} представлена
\<\<хорошая\>\> функция максимального правдоподобия, обеспечивающая
однозначное восстановление параметров $f$ и $\tau$.

Если антенне удается принять сигнал с трех и более спутников, то тогда
можно восстановить её координаты и скорость в текущий момент времени.
Так в 1 декабря 2020 года в 09:12:31 с помощью спутников a,b,c были
восстановлены следующие параметры

-   $Lon=33.9843$, $Lat=44.3929$, $Alt=9.46$ м

-   $Speed=0.07$ м/с

что соответствует условиям проведения эксперимента.

На рис. [4](#fig:2){reference-type="ref" reference="fig:2"} представлена
\<\<плохая\>\> функция максимального правдоподобия по которой параметры
однозначно восстановить нельзя

![Экспериментально полученная функция максимального правдоподобия
$\Gamma_{GLRT}$ для полосы частот $\pm 4$кГц с шагом $f_{step}=25$
Гц](imgs/acq_dump_G_1C_ch_0_5_sat_7_3D.png){#fig:1
width="0.8\\linewidth"}

![Экспериментально полученная функция максимального правдоподобия
$\Gamma_{GLRT}$ для полосы частот $\pm 4$кГц с шагом $f_{step}=25$
Гц](imgs/acq_dump_G_1C_ch_0_5_sat_7_2D.png){#fig:1
width="0.8\\linewidth"}

![Экспериментально полученная функция максимального правдоподобия
$\Gamma_{GLRT}$ для полосы частот $\pm 4$кГц
](imgs/acq_dump_G_1C_ch_0_2_sat_16_3D.png){#fig:2
width="0.8\\linewidth"}

### Узкая диаграмма направленности антенны {#узкая-диаграмма-направленности-антенны .unnumbered}

Дальнейшей задачей было с помощью антенны с узкой диаграммой
направленности получить сигнал только от одного спутника в прямой
видимости и этот же сигнал, отраженный от морской поверхности. Для этого
к входу приемника RTL2832U попеременно включались две антенны: одна из
них была направлена в сторону спутника, другая -- на морскую поверхность

![Функция максимального правдоподобия, полученная с антенны направленной
на морскую
поверхность](imgs/acq_dump_G_1C_ch_0_25_sat_24_3D_refl30.png){width="0.8\\linewidth"}

![Функция максимального правдоподобия, полученная с антенны направленной
на морскую
поверхность](imgs/acq_dump_G_1C_ch_0_25_sat_24_2D_refl30.png){width="0.8\\linewidth"}

![Функция максимального правдоподобия, полученная с антенны направленной
на
спутник](imgs/acq_dump_G_1C_ch_0_3122_sat_17_3D_direct30.png){width="0.8\\linewidth"}

![Функция максимального правдоподобия, полученная с антенны направленной
на
спутник](imgs/acq_dump_G_1C_ch_0_3122_sat_17_2D_direct30.png){width="0.8\\linewidth"}
